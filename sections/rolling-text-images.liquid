{% style %}
.section-{{section.id}} {
    --offset: 20vw;
    --move-initial: calc(-25% + var(--offset));
    --move-final: calc(-50% + var(--offset));
    width: 100%;
    mx-width: 100vw;
    overflow: hidden;
    padding-top: {{ section.settings.section_pt_mobile }}px;
    padding-bottom: {{ section.settings.section_pb_mobile }}px;
}
.section-{{section.id}} h2 {
    margin-top: {{ section.settings.heading_mt_mobile }}px;
    margin-bottom: {{ section.settings.heading_mb_mobile }}px;
}
.section-{{section.id}} .marquee__inner {
    width: fit-content;
    display: flex;
    position: relative;
    transform: translate3d(var(--move-initial), 0, 0);
    animation: marquee {{ section.settings.speed }}s linear infinite;
    animation-play-state: running; /* start moving by default */
}
.section-{{section.id}} .marquee__inner {
    gap: {{ section.settings.gap_mobile }}px;
}
.block-text {
    font-size: {{ section.settings.font_size }}px;
}
.block-image {
    width: {{ section.settings.image_width_mobile }}px;
    height: {{ section.settings.image_height_mobile }}px;
    border-radius: {{ section.settings.image_br }}px;
    overflow: hidden;
}
.block-item img{
    width: 100%;
    height: 100%;
    object-fit: cover;
}

@media screen and (min-width: 750px){
    .section-{{section.id}}{
        padding-top: {{ section.settings.section_pt }}px;
        padding-bottom: {{ section.settings.section_pb }}px;
    }
    .section-{{section.id}} h2 {
        margin-top: {{ section.settings.heading_mt }}px;
        margin-bottom: {{ section.settings.heading_mb }}px;
    }
    .section-{{section.id}} .marquee__inner {
        gap: {{ section.settings.gap }}px;
    }
    .section-{{section.id}} .block-image {
        width: {{ section.settings.image_width }}px;
        height: {{ section.settings.image_height }}px;
    }
}
{% endstyle %}

<div class="marquee section-{{section.id}}">
    <div class="page-width">
        <h2 class="marquee__heading inline-richtext font-weight-semibold {{ section.settings.heading_size }} {{ section.settings.heading_alignment }}">
            {{ section.settings.heading }}
        </h2>
        <div class="marquee__inner" aria-hidden="true">
            {% for i in (1..8) %}
                {% for block in section.blocks %}
                    <div class="block-item item-{{ block.type }} block-{{ block.type }} block-{{block.id}}" {{ block.shopify_attributes }}>
                        {% if block.type == 'text' %}
                            {{ block.settings.text }}
                        {% elsif block.type == 'image' and block.settings.image != blank %}
                            {{ block.settings.image | image_url: width: block.settings.image_width | image_tag }}
                        {% endif %}
                    </div>
                {% endfor %}
            {% endfor %}
        </div>
    </div>
</div>

{% schema %}
{
"name": "Marquee",
"settings": [
    {
      "type": "header",
      "content": "Content Settings"
    },
    {
        "type": "inline_richtext",
        "id": "heading",
        "default": "Over 100,000 sold",
        "label": "Heading"
    },
    {
        "type": "select",
        "id": "heading_size",
        "options": [
            {
                "value": "h2",
                "label": "t:sections.all.heading_size.options__1.label"
            },
            {
                "value": "h1",
                "label": "t:sections.all.heading_size.options__2.label"
            },
            {
                "value": "h0",
                "label": "t:sections.all.heading_size.options__3.label"
            },
            {
                "value": "hxl",
                "label": "t:sections.all.heading_size.options__4.label"
            },
            {
                "value": "hxxl",
                "label": "t:sections.all.heading_size.options__5.label"
            }
        ],
        "default": "h1",
        "label": "t:sections.all.heading_size.label"
    },
    {
      "type": "select",
      "id": "heading_alignment",
      "label": "Heading Alignment",
      "options": [
        {
          "value": "left",
          "label": "left"
        },
        {
          "value": "center",
          "label": "center"
        },
        {
          "value": "right",
          "label": "right"
        }        
      ],
      "default": "center"
    },
    {
      "type": "header",
      "content": "Heading Settings"
    },
    {
      "type": "number",
      "id": "heading_mt",
      "label": "Margin Top",
      "default": 0 
    },
    {
      "type": "number",
      "id": "heading_mt_mobile",
      "label": "Margin Top (Mobile)",
      "default": 0
    },
    {
      "type": "number",
      "id": "heading_mb",
      "label": "Margin Bottom",
      "default": 53 
    },
    {
      "type": "number",
      "id": "heading_mb_mobile",
      "label": "Margin Bottom (Mobile)",
      "default": 42
    },
    {
      "type": "header",
      "content": "Block Text Settings"
    },
    {
      "type": "text",
      "id": "font_size",
      "label": "Font Size ( Desktop )"
    },
    {
      "type": "text",
      "id": "font_size_mobile",
      "label": "Font Size ( Mobile )"
    },
    {
        "type": "color",
        "id": "text_color",
        "label": "Text color",
        "default": "#000000"
    },    
    {
      "type": "header",
      "content": "Block Image Settings"
    },      
    {
        "type": "range",
        "id": "image_width",
        "min": 10,
        "max": 300,
        "step": 5,
        "unit": "px",
        "label": "Image Width",
        "default": 150 
    },   
    {
        "type": "range",
        "id": "image_height",
        "min": 10,
        "max": 300,
        "step": 5,
        "unit": "px",
        "label": "Image Height",
        "default": 150 
    },
    {
        "type": "range",
        "id": "image_width_mobile",
        "min": 10,
        "max": 300,
        "step": 5,
        "unit": "px",
        "label": "Image Width ( Mobile )",
        "default": 150 
    }, 
    {
        "type": "range",
        "id": "image_height_mobile",
        "min": 10,
        "max": 300,
        "step": 5,
        "unit": "px",
        "label": "Image Height ( Mobile )",
        "default": 150 
    },  
    {
        "type": "range",
        "id": "image_br",
        "min": 0,
        "max": 100,
        "step": 2,
        "unit": "px",
        "label": "Image Roundness",
        "default": 2 
    },   
    {
      "type": "header",
      "content": "Marquee Settings"
    },
    {
        "type": "range",
        "id": "speed",
        "label": "Animation speed (seconds)",
        "min": 1,
        "max": 60,
        "step": 1,
        "default": 5
    },
    {
        "type": "range",
        "id": "gap",
        "label": "Gap",
        "min": 5,
        "max": 60,
        "step": 5,
        "default": 25
    },
    {
        "type": "range",
        "id": "gap_mobile",
        "label": "Gap ( Mobile )",
        "min": 5,
        "max": 60,
        "step": 5,
        "default": 25
    },
    {
        "type": "header",
        "content": "Layout Settings"
    },
    {
        "type": "range",
        "id": "section_pt",
        "label": "Padding Top",
        "min": 5,
        "max": 100,
        "step": 5,
        "default": 60
    },
    {
        "type": "range",
        "id": "section_pb",
        "label": "Padding Bottom",
        "min": 5,
        "max": 100,
        "step": 5,
        "default": 60
    },
    {
        "type": "range",
        "id": "section_pt_mobile",
        "label": "Padding Top ( Mobile )",
        "min": 5,
        "max": 100,
        "step": 5,
        "default": 30
    },
    {
        "type": "range",
        "id": "section_pb_mobile",
        "label": "Padding Bottom ( Bottom )",
        "min": 5,
        "max": 100,
        "step": 5,
        "default": 30
    }
    ],
    "blocks": [
        {
            "type": "text",
            "name": "Text item",
            "settings": [
                {
                    "type": "html",
                    "id": "text",
                    "label": "Text",
                    "default": "Your marquee text"
                }
            ]
        },
        {
            "type": "image",
            "name": "Image item",
            "settings": [
                {
                    "type": "image_picker",
                    "id": "image",
                    "label": "Image"
                }
            ]
        }
    ],
    "max_blocks": 20,
    "presets": [
        {
            "name": "Marquee",
            "category": "Custom",
            "blocks": [
                { "type": "text" },
                { "type": "image" }
            ]
        }
    ]
}
{% endschema %}